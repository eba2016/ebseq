<tool id="EBIsoformTwoCondTest" name="Isoform level DE test across two conditions" version="1.0.1">
  <description>Runs EBSeq to find DE isoforms across two conditions</description>

    <macros>
        <import>macros.xml</import>
    </macros>

    <expand macro="requirements"/>
    <expand macro="stdio"/>

  <command>R --quiet --slave --file=$__tool_directory__/EBIsoformTwoCondTest.R --args $Isoform_Expression $First_Row_Sample_Names $Conditions $Ig_Vector $Target_FDR $Output $Sorted_Output $Sorted_Outpu_with_target_FDR $Sizes 1>NUL 2>NUL</command>
  <inputs>
		<param name="Isoform_Expression" type="data" format="tabular" label="Isoform Expression (tab delimited, please use the unnormalized values, e.g. expected counts from RSEM)"/>
		<param name="First_Row_Sample_Names" type="select" format="text">
			<label>The First Row is Sample Names?</label>
			<option value="y">Yes</option>
			<option value="n">No</option>
			</param>
		<param name="Conditions" type="text" size="60" value="C1,C2" label="Enter which condition each
			sample belongs to (separated by comma, no space please)." 
			help="Sample with condition that comes first alphabetically will be in numerator (C1 relative to C2)."/>
		<param name="Ig_Vector" type="data" format="tabular" label="Ig Vector to define the uncertainty groups"/>
		<param name="Target_FDR" type="text" format="tabular" value="0.05" label="Target FDR"
			/>
  </inputs>
  <outputs>
		<data format="tabular" name="Output" label="Output"/>
		<data format="tabular" name="Sorted_Output" label="Output sorted by PP"/>
		<data format="tabular" name="Sorted_Outpu_with_target_FDR" label="Sorted output with target FDR"/>
		<data format="tabular" name="Sizes" label="Normalization factors"/>
  </outputs>

  <help>
The input Conditions should have exactly two levels. The length of the Condition vector should be exactly the same as the number of columns in the data file (except the isoform names column).

The Ig Vector could be generated by the GetIg function or obtained from RSEM output.

Four output files will be generated. Each of the first 3 files contains Posterior probability of being DE (PPDE), Fold Change (RealFC), Posterior Fold Change (PostFC) and normalized isoform expressions.
The four files are:

Isoforms with the same order as in input file;
Isoforms sorted by PPDE; DE Isoforms under target FDR (PPDE>=TargetFDR) 
and sorted by PPDE; 
Library size factor for each sample.

</help>

    <expand macro="citation" />

</tool>
