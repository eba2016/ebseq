<tool id="EBIsoformMultiCondTest" name="Isoform level DE test across multiple conditions" version="1.0.1">
  <description>Runs EBSeq to find DE isoforms across multiple (more than two) conditions</description>


    <macros>
        <import>macros.xml</import>
    </macros>

    <expand macro="requirements"/>
    <expand macro="stdio"/>

  <command>R --quiet --slave --file=$__tool_directory__/EBIsoformMultiCondTest.R --args $Isoform_Expression $First_Row_Sample_Names $Conditions $Ig_Vector $Patterns_of_Interests $PP_of_each_pattern $Pattern_with_highest_PP $Sizes 1>NUL 2>NUL</command>
  <inputs>
		<param name="Isoform_Expression" type="data" format="tabular" label="Isoform Expression (tab delimited, please use the unnormalized values, e.g. expected counts from RSEM)"/>
		<param name="First_Row_Sample_Names" type="select" format="text">
			<label>The First Row is Sample Names?</label>
			<option value="y">Yes</option>
			<option value="n">No</option>
			</param>
		<param name="Conditions" type="text" size="60" value="C1,C2,C3" label="Enter which condition each
			sample belongs to (separated by comma, no space please)." 
			help=""/>
		<param name="Ig_Vector" type="data" format="tabular" label="Ig Vector to define the uncertainty groups"/>
		<param name="Patterns_of_Interests" type="data" format="tabular" label="Patterns of Interests"/>
  </inputs>
  <outputs>
		<data format="tabular" name="PP_of_each_pattern" label="PP of each pattern"/>
		<data format="tabular" name="Pattern_with_highest_PP" label="Pattern with highest PP"/>
                <data format="tabular" name="Sizes" label="Normalization factors"/>
  </outputs>

  <help>
The input file and conditions should have more than two levels (for exactly two levels, please use the 'Isoform level DE test across two conditions' tool). Format of the Isoform Expression file should be transcript_id, EC1, EC2 ... Please do not include the gene name in this file. The length of the Condition vector should be exactly the same as the number of columns in the data file (except the isoform names column).

The patterns of interests could be obtained by function Get All Possible Patterns (and optionally, if there are too many patterns generated, the function Choose Patterns could be used to choose only subset of the patterns.)

The Ig Vector could be generated by the GetIg function or obtained from RSEM output.

Three output files will be generated. The first file contains the Posterior probability of being each pattern.
The second file contains the pattern with the highest PP for each isoform and the normalized expressions. Isoforms are with the same order as in input file.
The last file provides the library size factor for each sample.

</help>

    <expand macro="citation" />

</tool>
